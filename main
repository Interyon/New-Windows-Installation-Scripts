$driver_installation = {
  irm https://pastebin.com/raw/MFYQM8XC;
}

$battery_test = {
  irm https://pastebin.com/raw/17ZXA43H;
}

$windows_activation = {
  & ([ScriptBlock]::Create((irm https://get.activated.win))) /HWID;
}


Write-Host "Welcome to Brandon's Windows Activation and Driver Updater Script..."
Write-Host "Syncing System Clock...";
& ([ScriptBlock]::Create((irm https://pastebin.com/raw/ZsqtRXJ5)));
Write-Host "Done";
Write-Host "";

Write-Host "Installing WinGet Powershell Module from PSGallery...";
& ([ScriptBlock]::Create((irm https://pastebin.com/raw/KF970HMn)));
Write-Host "Done";
Write-Host "";

Write-Host "Installing Drivers...";
Start-Process Powershell -Verb RunAs -ArgumentList "-Command $driver_installation";
Write-Host "";

Write-Host "Running Battery Test...";
Start-Process Powershell -Verb RunAs -ArgumentList "-NoExit -Command $battery_test";
Write-Host "";

Write-Host "Activating Windows...";
Invoke-Expression $windows_activation;
Write-host "";
Write-Host "Reboot now to apply updates...";
